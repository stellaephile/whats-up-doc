{"ast":null,"code":"// Severity-Based Facility Routing System\n\n/**\n * Routing configuration based on severity levels\n */\nexport const routingConfig = {\n  mild: {\n    level: 'Mild',\n    facilityTypes: ['PHC', 'Dispensary', 'Health Centre'],\n    initialRadius: 3,\n    color: '#10b981',\n    // green\n    icon: 'ðŸŸ¢'\n  },\n  moderate: {\n    level: 'Moderate',\n    facilityTypes: ['Clinic', 'Nursing Home', 'Hospital'],\n    initialRadius: 5,\n    color: '#f59e0b',\n    // yellow/orange\n    icon: 'ðŸŸ¡'\n  },\n  high: {\n    level: 'High',\n    facilityTypes: ['Hospital', 'Multi-specialty Hospital'],\n    initialRadius: 10,\n    color: '#f97316',\n    // orange\n    icon: 'ðŸŸ '\n  },\n  emergency: {\n    level: 'Emergency',\n    facilityTypes: ['Emergency Centre', 'Hospital', 'Multi-specialty Hospital'],\n    initialRadius: 10,\n    requiresEmergency24x7: true,\n    color: '#ef4444',\n    // red\n    icon: 'ðŸ”´'\n  }\n};\n\n/**\n * Progressive radius expansion steps\n */\nexport const radiusExpansionSteps = [3, 5, 10, 20];\n\n/**\n * Get expansion message for UI\n */\nexport function getExpansionMessage(fromRadius, toRadius) {\n  const messages = {\n    '3-5': 'No facilities found nearby. Searching a wider area (5km)...',\n    '5-10': 'Still searching... expanding to 10km radius',\n    '10-20': 'Expanding to 20km â€” showing best available options',\n    'none': 'No facilities found within 20km. Please call 108 for emergency assistance.'\n  };\n  const key = `${fromRadius}-${toRadius}`;\n  return messages[key] || messages['none'];\n}\n\n/**\n * Filter facilities based on severity and radius\n */\nexport function filterFacilitiesBySeverity(facilities, severityLevel, radius) {\n  const config = routingConfig[severityLevel];\n  if (!config) {\n    console.warn(`Unknown severity level: ${severityLevel}`);\n    return facilities;\n  }\n  return facilities.filter(facility => {\n    // Check facility type\n    const matchesFacilityType = config.facilityTypes.includes(facility.facility_type);\n\n    // Check emergency requirement\n    if (config.requiresEmergency24x7 && !facility.emergency_24x7) {\n      return false;\n    }\n\n    // Check radius (if distance is available)\n    if (facility.distance_km && facility.distance_km > radius) {\n      return false;\n    }\n    return matchesFacilityType;\n  });\n}\n\n/**\n * Progressive search with radius expansion\n */\nexport function progressiveSearch(allFacilities, severityLevel) {\n  const config = routingConfig[severityLevel];\n  const results = {\n    facilities: [],\n    radiusUsed: config.initialRadius,\n    wasExpanded: false,\n    expansionSteps: []\n  };\n\n  // Try each radius step\n  for (const radius of radiusExpansionSteps) {\n    if (radius < config.initialRadius) continue;\n    const filtered = filterFacilitiesBySeverity(allFacilities, severityLevel, radius);\n    if (filtered.length > 0) {\n      results.facilities = filtered;\n      results.radiusUsed = radius;\n      results.wasExpanded = radius > config.initialRadius;\n      break;\n    }\n\n    // Track expansion attempts\n    if (radius > config.initialRadius) {\n      results.expansionSteps.push(radius);\n    }\n  }\n  return results;\n}\n\n/**\n * Calculate distance between two coordinates (Haversine formula)\n */\nexport function calculateDistance(lat1, lon1, lat2, lon2) {\n  const R = 6371; // Earth's radius in km\n  const dLat = toRad(lat2 - lat1);\n  const dLon = toRad(lon2 - lon1);\n  const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  const distance = R * c;\n  return distance;\n}\nfunction toRad(degrees) {\n  return degrees * (Math.PI / 180);\n}\n\n/**\n * Enrich facilities with distance and sort by distance\n */\nexport function enrichAndSortFacilities(facilities, userLat, userLon) {\n  return facilities.map(facility => ({\n    ...facility,\n    distance_km: calculateDistance(userLat, userLon, parseFloat(facility.latitude), parseFloat(facility.longitude))\n  })).sort((a, b) => a.distance_km - b.distance_km);\n}\n\n/**\n * Get severity badge configuration\n */\nexport function getSeverityBadge(severityLevel) {\n  const config = routingConfig[severityLevel];\n  return {\n    icon: config.icon,\n    label: config.level,\n    color: config.color,\n    bgColor: `${config.color}20`,\n    // 20% opacity\n    borderColor: config.color\n  };\n}","map":{"version":3,"names":["routingConfig","mild","level","facilityTypes","initialRadius","color","icon","moderate","high","emergency","requiresEmergency24x7","radiusExpansionSteps","getExpansionMessage","fromRadius","toRadius","messages","key","filterFacilitiesBySeverity","facilities","severityLevel","radius","config","console","warn","filter","facility","matchesFacilityType","includes","facility_type","emergency_24x7","distance_km","progressiveSearch","allFacilities","results","radiusUsed","wasExpanded","expansionSteps","filtered","length","push","calculateDistance","lat1","lon1","lat2","lon2","R","dLat","toRad","dLon","a","Math","sin","cos","c","atan2","sqrt","distance","degrees","PI","enrichAndSortFacilities","userLat","userLon","map","parseFloat","latitude","longitude","sort","b","getSeverityBadge","label","bgColor","borderColor"],"sources":["/Users/sonalgan/Desktop/whats-up-doc/whats-up-doc/frontend/src/facilityRouting.js"],"sourcesContent":["// Severity-Based Facility Routing System\n\n/**\n * Routing configuration based on severity levels\n */\nexport const routingConfig = {\n  mild: {\n    level: 'Mild',\n    facilityTypes: ['PHC', 'Dispensary', 'Health Centre'],\n    initialRadius: 3,\n    color: '#10b981', // green\n    icon: 'ðŸŸ¢'\n  },\n  moderate: {\n    level: 'Moderate',\n    facilityTypes: ['Clinic', 'Nursing Home', 'Hospital'],\n    initialRadius: 5,\n    color: '#f59e0b', // yellow/orange\n    icon: 'ðŸŸ¡'\n  },\n  high: {\n    level: 'High',\n    facilityTypes: ['Hospital', 'Multi-specialty Hospital'],\n    initialRadius: 10,\n    color: '#f97316', // orange\n    icon: 'ðŸŸ '\n  },\n  emergency: {\n    level: 'Emergency',\n    facilityTypes: ['Emergency Centre', 'Hospital', 'Multi-specialty Hospital'],\n    initialRadius: 10,\n    requiresEmergency24x7: true,\n    color: '#ef4444', // red\n    icon: 'ðŸ”´'\n  }\n};\n\n/**\n * Progressive radius expansion steps\n */\nexport const radiusExpansionSteps = [3, 5, 10, 20];\n\n/**\n * Get expansion message for UI\n */\nexport function getExpansionMessage(fromRadius, toRadius) {\n  const messages = {\n    '3-5': 'No facilities found nearby. Searching a wider area (5km)...',\n    '5-10': 'Still searching... expanding to 10km radius',\n    '10-20': 'Expanding to 20km â€” showing best available options',\n    'none': 'No facilities found within 20km. Please call 108 for emergency assistance.'\n  };\n  \n  const key = `${fromRadius}-${toRadius}`;\n  return messages[key] || messages['none'];\n}\n\n/**\n * Filter facilities based on severity and radius\n */\nexport function filterFacilitiesBySeverity(facilities, severityLevel, radius) {\n  const config = routingConfig[severityLevel];\n  \n  if (!config) {\n    console.warn(`Unknown severity level: ${severityLevel}`);\n    return facilities;\n  }\n  \n  return facilities.filter(facility => {\n    // Check facility type\n    const matchesFacilityType = config.facilityTypes.includes(facility.facility_type);\n    \n    // Check emergency requirement\n    if (config.requiresEmergency24x7 && !facility.emergency_24x7) {\n      return false;\n    }\n    \n    // Check radius (if distance is available)\n    if (facility.distance_km && facility.distance_km > radius) {\n      return false;\n    }\n    \n    return matchesFacilityType;\n  });\n}\n\n/**\n * Progressive search with radius expansion\n */\nexport function progressiveSearch(allFacilities, severityLevel) {\n  const config = routingConfig[severityLevel];\n  const results = {\n    facilities: [],\n    radiusUsed: config.initialRadius,\n    wasExpanded: false,\n    expansionSteps: []\n  };\n  \n  // Try each radius step\n  for (const radius of radiusExpansionSteps) {\n    if (radius < config.initialRadius) continue;\n    \n    const filtered = filterFacilitiesBySeverity(allFacilities, severityLevel, radius);\n    \n    if (filtered.length > 0) {\n      results.facilities = filtered;\n      results.radiusUsed = radius;\n      results.wasExpanded = radius > config.initialRadius;\n      break;\n    }\n    \n    // Track expansion attempts\n    if (radius > config.initialRadius) {\n      results.expansionSteps.push(radius);\n    }\n  }\n  \n  return results;\n}\n\n/**\n * Calculate distance between two coordinates (Haversine formula)\n */\nexport function calculateDistance(lat1, lon1, lat2, lon2) {\n  const R = 6371; // Earth's radius in km\n  const dLat = toRad(lat2 - lat1);\n  const dLon = toRad(lon2 - lon1);\n  \n  const a = \n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *\n    Math.sin(dLon / 2) * Math.sin(dLon / 2);\n  \n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  const distance = R * c;\n  \n  return distance;\n}\n\nfunction toRad(degrees) {\n  return degrees * (Math.PI / 180);\n}\n\n/**\n * Enrich facilities with distance and sort by distance\n */\nexport function enrichAndSortFacilities(facilities, userLat, userLon) {\n  return facilities\n    .map(facility => ({\n      ...facility,\n      distance_km: calculateDistance(\n        userLat,\n        userLon,\n        parseFloat(facility.latitude),\n        parseFloat(facility.longitude)\n      )\n    }))\n    .sort((a, b) => a.distance_km - b.distance_km);\n}\n\n/**\n * Get severity badge configuration\n */\nexport function getSeverityBadge(severityLevel) {\n  const config = routingConfig[severityLevel];\n  return {\n    icon: config.icon,\n    label: config.level,\n    color: config.color,\n    bgColor: `${config.color}20`, // 20% opacity\n    borderColor: config.color\n  };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}